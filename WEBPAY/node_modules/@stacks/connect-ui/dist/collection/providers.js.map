{"version":3,"file":"providers.js","sourceRoot":"","sources":["../src/providers.ts"],"names":[],"mappings":"AAAA,4BAA4B;AAE5B,OAAO,EAAE,qBAAqB,EAAE,MAAM,WAAW,CAAC;AAuClD,MAAM,CAAC,MAAM,sBAAsB,GAAG,GAAG,EAAE;IACzC,IAAI,OAAO,MAAM,KAAK,WAAW;QAAE,OAAO,EAAE,CAAC;IAE7C,MAAM,eAAe,GAAG,MAAM,CAAC,oBAAoB,IAAI,EAAE,CAAC;IAC1D,MAAM,aAAa,GAAG,MAAM,CAAC,cAAc,IAAI,EAAE,CAAC;IAElD,OAAO,CAAC,GAAG,eAAe,EAAE,GAAG,aAAa,CAAC,CAAC;AAChD,CAAC,CAAC;AAEF,MAAM,CAAC,MAAM,qBAAqB,GAAG,CAAC,mBAAmC,EAAE,EAAE,EAAE;IAC7E,IAAI,OAAO,MAAM,KAAK,WAAW;QAAE,OAAO,EAAE,CAAC;IAE7C,MAAM,mBAAmB,GAAG,sBAAsB,EAAE,CAAC;IAErD,MAAM,4BAA4B,GAAG,gBAAgB,CAAC,MAAM,CAAC,eAAe,CAAC,EAAE;QAC7E,sCAAsC;QACtC,IAAI,mBAAmB,CAAC,IAAI,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,KAAK,eAAe,CAAC,EAAE,CAAC;YAAE,OAAO,KAAK,CAAC;QAE/E,kEAAkE;QAClE,MAAM,QAAQ,GAAG,iBAAiB,CAAC,eAAe,CAAC,EAAE,CAAC,CAAC;QACvD,OAAO,CAAC,CAAC,QAAQ,CAAC;IACpB,CAAC,CAAC,CAAC;IAEH,OAAO,mBAAmB,CAAC,MAAM,CAAC,4BAA4B,CAAC,CAAC;AAClE,CAAC,CAAC;AAEF;;;GAGG;AACH,MAAM,CAAC,MAAM,kBAAkB,GAAG,GAAG,EAAE;IACrC,OAAO,CAAC,CAAC,qBAAqB,EAAE,CAAC;AACnC,CAAC,CAAC;AAEF;;;;GAIG;AACH,MAAM,CAAC,MAAM,WAAW,GAAG,GAAG,EAAE;IAC9B,MAAM,UAAU,GAAG,qBAAqB,EAAE,CAAC;IAC3C,OAAO,iBAAiB,CAAC,UAAU,CAAC,CAAC;AACvC,CAAC,CAAC;AAEF,MAAM,CAAC,MAAM,iBAAiB,GAAG,CAAC,EAAsB,EAAE,EAAE;IAC1D,OAAO,EAAE,aAAF,EAAE,uBAAF,EAAE,CAAE,KAAK,CAAC,GAAG,EAAE,MAAM,CAAC,CAAC,GAAG,EAAE,IAAI,EAAE,EAAE,CAAC,GAAG,aAAH,GAAG,uBAAH,GAAG,CAAG,IAAI,CAAC,EAAE,MAAM,CAAC,CAAC;AACnE,CAAC,CAAC","sourcesContent":["// AUTO REGISTERED PROVIDERS\n\nimport { getSelectedProviderId } from './session';\n\n/** Backwards compatible alias for `WbipProvider` */\nexport type WebBTCProvider = WbipProvider;\n\nexport interface WbipProvider {\n  /** The global \"path\" of the provider (e.g. `\"MyProvider\"` if registered at `window.MyProvider`) */\n  id: string;\n  /** The name of the provider, as displayed to the user */\n  name: string;\n  /** The data URL of an image to show (e.g. `data:image/png;base64,iVBORw0...`) @see https://developer.mozilla.org/en-US/docs/Web/HTTP/Basics_of_HTTP/Data_URLs */\n  icon?: string;\n  /** Web URL of the provider */\n  webUrl?: string;\n\n  chromeWebStoreUrl?: string;\n  mozillaAddOnsUrl?: string;\n  googlePlayStoreUrl?: string;\n  iOSAppStoreUrl?: string;\n}\n\ndeclare global {\n  interface Window {\n    /**\n     * @experimental @beta\n     * An experimental global registry of providers that can be used by the UI to display a list of providers to the user.\n     * Wallets can add their provider to this list without needing to update `@stacks/connect` itself.\n     * This is an experimental API and may change in the future.\n     * This will be used as a test-run before switching to `webbtc` and WBIP004.\n     * The provider objects are WBIP004 compliant.\n     * It may happen that no wallet implements this feature before `@stacks/connect` switches to `webbtc`.\n     */\n    webbtc_stx_providers?: WbipProvider[];\n\n    /** @experimental @beta */\n    wbip_providers?: WbipProvider[];\n  }\n}\n\nexport const getRegisteredProviders = () => {\n  if (typeof window === 'undefined') return [];\n\n  const legacyProviders = window.webbtc_stx_providers || [];\n  const wbipProviders = window.wbip_providers || [];\n\n  return [...legacyProviders, ...wbipProviders];\n};\n\nexport const getInstalledProviders = (defaultProviders: WbipProvider[] = []) => {\n  if (typeof window === 'undefined') return [];\n\n  const registeredProviders = getRegisteredProviders();\n\n  const additionalInstalledProviders = defaultProviders.filter(defaultProvider => {\n    // already registered, don't add again\n    if (registeredProviders.find(rp => rp.id === defaultProvider.id)) return false;\n\n    // check if default provider is installed (even if not registered)\n    const provider = getProviderFromId(defaultProvider.id);\n    return !!provider;\n  });\n\n  return registeredProviders.concat(additionalInstalledProviders);\n};\n\n/**\n * Check if a wallet provider was previously selected via Connect.\n * @returns `true` if a provider was selected, `false` otherwise.\n */\nexport const isProviderSelected = () => {\n  return !!getSelectedProviderId();\n};\n\n/**\n * Get the currently selected wallet provider.\n * Note that this will not return the default `window.StacksProvider` object.\n * @returns The wallet provider object, or null if no provider is selected.\n */\nexport const getProvider = () => {\n  const providerId = getSelectedProviderId();\n  return getProviderFromId(providerId);\n};\n\nexport const getProviderFromId = (id: string | undefined) => {\n  return id?.split('.').reduce((acc, part) => acc?.[part], window);\n};\n"]}