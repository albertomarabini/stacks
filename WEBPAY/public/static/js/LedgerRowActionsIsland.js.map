{
  "version": 3,
  "sources": ["../../../src/client/islands/LedgerRowActionsIsland.ts"],
  "sourcesContent": ["/* eslint-disable no-alert, no-console */\ntype PageData = {\n    kind: 'invoices' | 'subscriptions';\n    storeId: string;\n    csrfToken?: string | null;\n  };\n  const data: PageData = (window as any).__PAGE__ || { kind: 'invoices', storeId: '' };\n\n  // meta fallback (same pattern as Filter island)\n  function readMetaCsrf() {\n    const m = document.querySelector('meta[name=\"csrf-token\"]') as HTMLMetaElement | null;\n    return m?.content || null;\n  }\n\n  async function post(url: string, body: Record<string, any> = {}) {\n    const qs = new URLSearchParams();\n    for (const [k, v] of Object.entries(body)) qs.append(k, String(v ?? ''));\n\n    const token = data.csrfToken || readMetaCsrf();\n    if (token && !qs.get('_csrf')) qs.append('_csrf', token);\n\n    const res = await fetch(url, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/x-www-form-urlencoded; charset=UTF-8',\n      },\n      body: qs.toString(),\n      credentials: 'same-origin',\n    });\n    if (!res.ok) throw new Error(`HTTP ${res.status}`);\n\n    document.querySelector<HTMLFormElement>('#invoice-filter-form, #subscription-filter-form')\n      ?.dispatchEvent(new Event('submit', { bubbles: true, cancelable: true }));\n  }\n\n\nfunction $(sel: string, root: Document | HTMLElement = document) {\n    return Array.from(root.querySelectorAll(sel)) as HTMLElement[];\n}\nfunction bind() {\n    // Invoice actions\n    $('[data-row-kind=\"invoice\"]').forEach(row => {\n        const invoiceId = row.getAttribute('data-invoice-id')!;\n        row.querySelector<HTMLElement>('[data-action=\"view-invoice\"]')?.addEventListener('click', () => {\n            window.location.href = `/invoice/${encodeURIComponent(invoiceId)}`;\n        });\n        row.querySelector<HTMLElement>('[data-action=\"cancel-invoice\"]')?.addEventListener('click', async () => {\n            if (!confirm('Cancel this invoice?')) return;\n            await post(`/merchant/${encodeURIComponent(data.storeId)}/invoices/${encodeURIComponent(invoiceId)}/cancel`);\n        });\n        row.querySelector<HTMLElement>('[data-action=\"archive-invoice\"]')?.addEventListener('click', async () => {\n            if (!confirm('Archive this invoice?')) return;\n            await post(`/merchant/${encodeURIComponent(data.storeId)}/invoices/${encodeURIComponent(invoiceId)}/archive`);\n        });\n        row.querySelector<HTMLElement>('[data-action=\"refund-invoice\"]')?.addEventListener('click', async () => {\n            const amt = prompt('Refund amount (sats):', '0');\n            if (!amt) return;\n            const memo = prompt('Refund memo (optional):', '') || '';\n            await post(`/merchant/${encodeURIComponent(data.storeId)}/invoices/${encodeURIComponent(invoiceId)}/refund`, { amount: amt, memo });\n        });\n    });\n\n    // Subscription actions\n    $('[data-row-kind=\"subscription\"]').forEach(row => {\n        const subId = row.getAttribute('data-subscription-id')!;\n        row.querySelector<HTMLElement>('[data-action=\"cancel-subscription\"]')?.addEventListener('click', async () => {\n            if (!confirm('Cancel this subscription?')) return;\n            await post(`/merchant/${encodeURIComponent(data.storeId)}/subscriptions/${encodeURIComponent(subId)}/cancel`);\n        });\n        row.querySelector<HTMLElement>('[data-action=\"invoice-now\"]')?.addEventListener('click', async () => {\n            const ttl = prompt('Invoice TTL seconds (120..1800):', '900') || '900';\n            const memo = prompt('Memo (optional):', '') || '';\n            await post(`/merchant/${encodeURIComponent(data.storeId)}/subscriptions/${encodeURIComponent(subId)}/invoice-now`, { ttl, memo });\n        });\n    });\n}\n\n// initial\nbind();\n// rebind after the ledger partial is re-rendered\ndocument.addEventListener('ledger:updated', bind);\n"],
  "mappings": "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",
  "names": []
}
